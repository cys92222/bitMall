<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style type="text/css">
#div1,#div2{
	display: none;
/* 	display: block */
}
</style>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script type="text/javascript">
$(function(){
	var arr;
	var idx;
	$.getJSON("listGoods",function(data){
		$.each(data,function(idx,g){
			arr = data;
			idx = idx;
			var ggg = data[idx].no;
			var td1 = $("<td></td>").html(g.no);
			var td2 = $("<td></td>").html(g.item);
			var btndel = $("<button>삭제</button>");
			var tr = $("<tr id='tr_in'></tr>").append(td1,td2,btndel);
			$("#tb1").append(tr);
			
			//상품삭제
			$(btndel).on("click",function(){
				var in_no = {no:data[idx].no};
				$.ajax("deleteGoods",{data:in_no,success:function(){
					alert("상품삭제");
					window.location.reload(true)

				}})
			})
			
			//상품클릭하면
			$(td1).on("click",function(){
	 			var in_no = {no:data[idx].no};
	 			//alert(no);
	 			$("#div1").css("display","block");
	 			$("#div2").css("display","none");
	 			$.ajax("getGoods",{data:in_no,success:function(r){
	 				$("#no").val(r.no);
	 				$("#item").val(r.item);
	 				$("#qty").val(r.qty);
	 				$("#price").val(r.price);
	 				$("#img").attr({"src":"img/"+r.fname,"width":100,"height":100});
	 				
	 				$("#detail").val(r.detail);
	 			}})
	 		})
	 		
	 		
		})
	})
	
	//상품등록
	$("#btnAdd").click(function(){
		$("#div2").css("display","block");
		$("#div1").css("display","none");
		$("#add").click(function(){
			var data = $("#f").serialize()
			$.ajax("insertGoods",{data:data,success:function(r){
				alert(r);
			}})
		
			window.location.reload(true)
			})
		})
		
	
	
	
	
})
</script>
</head>
<body>
<h2>상품목록</h2>
<hr>

	<table id="tb1" border="1" width="80%">
		<tr>
			<td>상품번호</td><td>상품이름</td>
		</tr>

	</table>
	<!-- 수정폼 -->
<div id="div1">
<form id="f_up">
	<table border="1">
		<tr>
			<td>상품번호</td><td>상품이름</td><td>상품수량</td><td>상품가격</td><td>사진</td><td>상세설명</td>
		</tr>
		<tr>
			<td> <input type="text" id="no" name="no"> </td>
			<td> <input type="text" id="item" name="item"> </td>
			<td> <input type="text" id="qty" name="qty"> </td>
			<td> <input type="text" id="price" name="price"> </td>
			<td> <img src="" id="img"></td>
			<td> <textarea rows="8" cols="10" id="detail" name="detail"></textarea> </td>
		</tr>
	</table>	
	</div>
</form>


<!-- 등록폼 -->
<div id="div2">

        <form id="f" class="form">
           <h2>상품 정보 등록</h2>
           	  <div class="form-control">
              <label for="no">상품번호</label>
              <input type="number" id="no" name="no" placeholder="상품번호를 입력하세요.">
              </div>
              <div class="form-control">
              <label for="item">상품이름</label>
              <input type="text" id="item" name="item" placeholder="상품이름을 입력하세요.">
              </div>
              <div class="form-control">
              <label for="price">상품가격</label>
              <input type="number" id="price" name="price" placeholder="상품가격을 입력하세요.">
              </div>
              <div class="form-control">
              <label for="qty">상품수량</label>
              <input type="text" id="qty" name="qty" placeholder="상품수량을 입력하세요.">
              </div>
              <div class="form-control">
              <label for="fname">상품사진</label>
              <input type="text" id="uploadFile" name="uploadFile" placeholder="상품사진을 입력하세요.">
              </div>
              <div class="form-control">
              <label for="fname">상품상세</label>
              <textarea cols="80" rows="10" id="detail"name="detail"></textarea>
              </div>
			<button type="button" id="add">등록</button>
        </form>
	
</div>

<button id="btnAdd">상품등록</button><button id="btnUp">상품수정</button><br>
</body>
</html>